<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SVLF EMI Calculator (Flat-Rate)</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

  <script>
    function toggleInterestFields() {
      const type = document.querySelector('input[name="interest_type"]:checked').value;
      document.getElementById('interest_percent_group').style.display =
        type === 'percent' ? 'block' : 'none';
      document.getElementById('interest_rupees_group').style.display =
        type === 'rupees' ? 'block' : 'none';
    }
    document.addEventListener('DOMContentLoaded', toggleInterestFields);
  </script>
</head>

<body class="bg-dark text-light">
<div class="container py-4">

  <h1 class="h3 mb-2 text-center">SVLF EMI Calculator</h1>
  <p class="text-muted text-center">
    Processing charges are added to principal before interest calculation.
  </p>

  {% if error %}
    <div class="alert alert-danger">{{ error }}</div>
  {% endif %}

  <div class="card bg-secondary-subtle text-light">
    <div class="card-body">
      <form method="post" class="row g-3">

        <!-- Loan -->
        <div class="col-md-6">
          <label class="form-label">Loan Amount (₹)</label>
          <input type="number" step="0.01" min="0"
                 name="loan" class="form-control"
                 value="{{ data.loan }}" required>
        </div>

        <div class="col-md-6">
          <label class="form-label">Tenure (months)</label>
          <input type="number" step="1" min="1"
                 name="months" class="form-control"
                 value="{{ data.months }}" required>
        </div>

        <!-- Processing Charges -->
        <div class="col-12">
          <label class="form-label">Processing Charges (%)</label>
          <input type="number" step="0.01" min="0"
                 name="pc_percent" class="form-control"
                 value="{{ data.pc_percent }}">
          <div class="form-text">Default: 10% of loan amount</div>
        </div>

        <!-- Interest Type -->
        <div class="col-12">
          <label class="form-label">Interest Type</label><br>

          <div class="form-check form-check-inline">
            <input class="form-check-input"
                   type="radio"
                   name="interest_type"
                   value="percent"
                   onclick="toggleInterestFields()"
                   {% if data.interest_type == 'percent' %}checked{% endif %}>
            <label class="form-check-label">% per annum</label>
          </div>

          <div class="form-check form-check-inline">
            <input class="form-check-input"
                   type="radio"
                   name="interest_type"
                   value="rupees"
                   onclick="toggleInterestFields()"
                   {% if data.interest_type == 'rupees' %}checked{% endif %}>
            <label class="form-check-label">₹ per month</label>
          </div>
        </div>

        <!-- Interest Inputs -->
        <div class="col-md-6" id="interest_percent_group">
          <label class="form-label">Interest (% per annum)</label>
          <input type="number" step="0.01" min="0"
                 name="interest_percent"
                 class="form-control"
                 value="{{ data.interest_percent }}">
        </div>

        <div class="col-md-6" id="interest_rupees_group">
          <label class="form-label">Interest (₹ per month)</label>
          <input type="number" step="0.01" min="0"
                 name="interest_rupees"
                 class="form-control"
                 value="{{ data.interest_rupees }}">
        </div>

        <div class="col-12 text-end">
          <button class="btn btn-success" type="submit">
            Calculate EMI
          </button>
        </div>

      </form>
    </div>
  </div>
{% if result %}
<div class="card bg-dark text-white border border-secondary mt-4">
  <div class="card-body">
    <h5 class="card-title">Results</h5>

    <div class="row g-3">
      <div class="col-md-4">
        <div class="text-secondary">Processing Amount</div>
        <div class="fs-5 fw-bold">₹ {{ result.processing_amount }}</div>
      </div>

      <div class="col-md-4">
        <div class="text-secondary">Adjusted Principal</div>
        <div class="fs-5 fw-bold">₹ {{ result.adjusted_principal }}</div>
      </div>

      <div class="col-md-4">
        <div class="text-secondary">Total Interest</div>
        <div class="fs-5 fw-bold">₹ {{ result.total_interest }}</div>
      </div>
    </div>

    <div class="row g-3 mt-2">
      <div class="col-md-6">
        <div class="text-secondary">Total Payable</div>
        <div class="fs-5 fw-bold">₹ {{ result.total_payable }}</div>
      </div>

      <div class="col-md-6">
        <div class="text-secondary">Monthly EMI</div>
        <div class="fs-5 fw-bold">₹ {{ result.emi }}</div>
      </div>
    </div>
  </div>
</div>
{% endif %}


  <footer class="text-center text-muted mt-4">
    <small>© 2026 SVLF EMI Calculator</small>
  </footer>

</div>
</body>
</html>
